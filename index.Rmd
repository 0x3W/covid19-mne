---
title: "Crna Gora COVID-19"
featuredImage: "Users/Dovla/Desktop/img.png"
author: "W"
output: 
  flexdashboard::flex_dashboard:
    theme: cosmo
    orientation: rows
    social: menu
    source_code: embed

---

```{r setup, include=FALSE}
library(ggplot2)
library(plotly)
library(plyr)
library(flexdashboard)
library(tidyverse)
library(leaflet)
library(stringr)
library(sf)
library(here)
library(widgetframe)
library(tidyr)
library(DT)

mne <- read.csv("/Users/Dovla/Desktop/covidMNE2703.csv")
```

Mapa oboljelih
=======================================================================

Row
-----------------------------------------------------------------------

### Samoizolacija

```{r}
articles <- 6278
valueBox(articles, icon = "fa-home", color = "success")
```

### COVID-19 slucajevi

```{r}
comments <- 84
valueBox(comments, icon = "fa-notes-medical", color = "warning")
```

### Umrli

```{r}
spam <- 1
valueBox(spam, 
         icon = "fa-battery-empty",
         color = "danger")
```

Row 
-----------------------------------------------------------------------

### Mapa

```{r,fig.width = 12, echo=FALSE, warning=FALSE}
mapa <- na.omit(read.csv("/Users/Dovla/Desktop/grad.csv"))
m <- leaflet() %>%
  addTiles(urlTemplate = 'http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png') 
#m %>%
#  frameWidget()
leaflet(data = mapa) %>%
  addTiles() %>%
  addMarkers(clusterOptions = markerClusterOptions())  #%>%  frameWidget()
```

### Novi COVID-19 slucajevi

```{r}
mne22 <- subset(mne[mne$InfectedNew>0,])
p3 <- ggplot(data=mne22, aes(x=Day, y=InfectedNew)) + geom_bar(stat="identity",color="red", fill="white") +
  labs(x="Dana od 9/3 tj epidemije", y = "Novih slucajeva") + coord_flip()
ggplotly(p3) 
```

Podaci JIZCG
=======================================================================

Row
-----------------------------------------------------------------------

### Evolucija COVID-19 slucajeva 

```{r}

mne <- read.csv("/Users/Dovla/Desktop/covidMNE2703.csv")
mne$InfectionRate1 <- as.numeric(levels(mne$InfectionRate))[mne$InfectionRate]
myvars <- c("Day","Infected", "Tested")#, "UnderWatch")
mne1 <- mne[myvars]
#mne1$UnderWatch <- mne1$UnderWatch/10
names(mne1) <- c("Day","covid-19", "Testirano")#, "Izolacija / 10")
mne2 <- mne1 %>%
  pivot_longer(-Day, names_to = "Legenda", values_to = "count")

p11 <- ggplot(mne2, aes(x=Day, y=count,group = Legenda)) + geom_line(aes(linetype=Legenda)) + geom_point() +
    labs(x = "Proslo dana od 09/03/2020 tj prvog dana izvjestavanja o CG", y = "") 
#p11 <- ggplot(mne2, aes(x=Day, y=count, col=series)) + geom_line() + geom_point()
ggplotly(p11)

```

### Konts

```{r,echo=FALSE, warning=FALSE}
library(igraph)
library(sna)
library(GGally)

gra <- read.csv("/Users/Dovla/Desktop/gra.csv")
graC <- read.csv("/Users/Dovla/Desktop/nodCol.csv")
g1 <- graph.data.frame(gra, directed=FALSE)
V(g1)$color <- "red"
V(g1)[gra$e]$color = "green"


#plot(g1, vertex.size = 10, edge.size=0.1, edge.color = "black", lty = 0, arrow.mode=3, arrow.size = 3, main="MNE covid19 clusters 29/03/2020")

#library(visNetwork)
#visIgraph(g1)

g2 <- ggnet2(g1,label = TRUE, label.size = 3, label.color="black",layout.par = list(cell.jitter = 0.75), 
             size = as.character(graC$s), size.palette = c("lar" = 8, "sma" = 3),
             shape = as.character(graC$s),
             node.color = c(rep("red",22),rep("darkgreen",62)),
             legend.size = 5)

ggplotly(g2)
```

Row
-----------------------------------------------------------------------

### Stopa rasta novih COVID-19 slucajeva

```{r}
p2 <- ggplot(data=mne, aes(x=Day, y=InfectionRate1*100, group=1)) + geom_line(linetype = "dashed", colour="red") +
  geom_point() +
  labs(x = "Proslo dana od 09/03/2020 tj prvog dana izvjestavanja o CG", y = "Stopa u %") 
ggplotly(p2)

```


### Novi COVID-19 slucajevi

```{r}
p3 <- ggplot(data=mne, aes(x=Day, y=InfectedNew)) + geom_bar(stat="identity",color="red", fill="white") +
  labs(x = "Proslo dana od 09/03/2020 tj prvog dana izvjestavanja o CG", y = "Novih slucajeva") 
ggplotly(p3)
```

Test
=======================================================================
```{r,fig.width=15,fig.height=20,results='asis'}
knitr::include_app("https://praeconium.shinyapps.io/myapp/")
```



